
<div class="wrapper col1" onload="init()">
  <div id="topbar">
    <ul>
      <li id="text_topbar">Log in for admin</li>
      <li class="last">
        <button id="connection_button"> Login</button>
      </li>
    </ul>
    <br class="clear"/>
  </div>
</div>


<script>
  let admin = false;

  async function checkToken() {

    let req = await fetch("/api/token", {
      method: "GET",
      headers: {
        'Content-Type': 'application/json'
      }
    })

    let res = await req.json();
    if (res === "logged") {
      document.getElementById("connection_button").innerHTML = "Logout";
      document.getElementById("text_topbar").innerHTML = "Welcome admin";
      admin = true;
      document.getElementById("connection_button").addEventListener("click", async () => {
        let req = await fetch("/api/logout", {
          method: "GET",
          headers: {
            'Content-Type': 'application/json'
          }
        })
        let res = await req.json();
        if (res === "logged out") {
          window.location.href = "http://localhost:8081/locations";
        }
      });
    }

  }

  function init() {
    checkToken();
  }

</script>

<div class="wrapper col2">
  <div id="header">
    <div id="topnav">
      <ul>
        <li class="last active"><a href="#">Sports & Events</a>
          <ul>
            <li><a href="http://localhost:8081/sports">Sports</a></li>
            <li id="admin_sport"><a href="http://localhost:8081/sportsAdmin">Sport Admin</a></li>
            <li><a href="http://localhost:8081/events">Events</a></li>
            <li id="admin_event"><a href="http://localhost:8081/eventAdmin">Event Admin</a></li>
            <li><a href="http://localhost:8081/locations">Locations</a></li>
            <li id="admin_location"><a href="http://localhost:8081/locationAdmin">Location Admin</a></li>
          </ul>
        </li>
        <li><a href="http://localhost:8081/stats">Stats</a></li>
        <li><a href="http://localhost:8081/athletes">Participants</a>
          <ul id="admin_athletes">
            <li><a href="http://localhost:8081/athletesAdmin">Athletes Admin</a></li>
          </ul>
        </li>
        <li><a href="http://localhost:8081/">Homepage</a></li>
      </ul>
    </div>
    <div id="logo">
      <h1><a href="http://localhost:8081/">Olympics Games 2024</a></h1>
    </div>
    <br class="clear"/>
  </div>
</div>


<div id="modal_connection" class="modal">
  <div id="modal_connection_content" class="modal-content">
    <span class="close"> &times; </span>
    <h2 class="modal-text"> Please enter your credentials </h2>
    <form action="/api/login" method="post" style="text-align: center">
      <label for="username"> Username </label>
      <input type="text" name="username" id="username" placeholder="Username" required>
      <label for="password"> Password </label>
      <input type="password" name="password" id="password" placeholder="Password" required>
      <input type="submit" value="Login">
    </form>
  </div>
</div>



<script>
  let login_button = document.getElementById("connection_button");
  let modal = document.getElementById("modal_connection");
  let span = document.getElementsByClassName("close")[0];

  span.onclick = function () {
    modal.style.display = "none";
  };

  window.onclick = function (event) {
    if (event.target === modal) {
      modal.style.display = "none";
    }
  };

  login_button.addEventListener("click", function () {
    modal.style.display = "block";
  });


  function checkAdmin() {
    if (!admin) {
      document.getElementById("admin_sport").style.display = "none";
      document.getElementById("admin_event").style.display = "none";
      document.getElementById("admin_location").style.display = "none";
      document.getElementById("admin_athletes").style.display = "none";
    }
  }

  checkAdmin();

</script>